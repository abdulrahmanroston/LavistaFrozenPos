المشكلة هي أنك قمت بتعريف المتغير `savedCashierName` مرتين في دالة `init()`. إليك الحل:

**احذف هذا الجزء المكرر من دالة `init()`:**

```javascript
// احذف هذا الجزء (السطور المكررة)
const savedCashierName = localStorage.getItem('posCashierName');
if (savedCashierName) {
cashierName = savedCashierName;
}
```

**واتركه فقط في المكان الصحيح. إليك دالة `init()` المصححة:**

```javascript
function init() {
// تحميل اسم الكاشير
const savedCashierName = localStorage.getItem('posCashierName');
if (savedCashierName) {
cashierName = savedCashierName;
}

// تحميل بيانات الشيفت المحفوظة
const savedShiftData = localStorage.getItem('posShiftData');
if (savedShiftData) {
const shiftData = JSON.parse(savedShiftData);
if (shiftData.isOpen) {
isShiftOpen = true;
shiftStartTime = new Date(shiftData.startTime);
shiftOrders = shiftData.orders || [];

document.getElementById('shift-btn').innerHTML = '<i class="fas fa-stop"></i> Close Shift';
document.getElementById('shift-btn').style.background = '#dc3545';
document.getElementById('shift-info').style.display = 'block';
document.getElementById('shift-status').textContent = 'Open';
document.getElementById('shift-start-time').textContent = shiftStartTime.toLocaleString();
updateShiftInfo();
}
}

// تحميل عناصر الطلب المحفوظة
const savedOrderItems = localStorage.getItem('posOrderItems');
if (savedOrderItems) {
orderItems = JSON.parse(savedOrderItems);
renderOrderItems();
}

// إضافة مستمعي الأحداث لأزرار المخازن
document.querySelectorAll('.warehouse-btn').forEach(button => {
button.addEventListener('click', () => {
const warehouse = button.dataset.warehouse;
fetchProducts(warehouse);
});
});

// فتح مخزن lavista تلقائياً
const defaultWarehouse = 'lavista';
fetchProducts(defaultWarehouse);

// إضافة مستمع حدث لرسوم التوصيل
document.getElementById('delivery_fee').addEventListener('input', updateOrderSummary);
}
```

**أيضاً أضف هذه المتغيرات المفقودة في بداية الكود JavaScript (بعد المتغيرات الموجودة):**

```javascript
// أضف هذه المتغيرات المفقودة
let isShiftOpen = false;
let shiftStartTime = null;
let shiftOrders = [];

function toggleShift() {
if (!isShiftOpen) {
openShift();
} else {
closeShift();
}
}
```

**وأيضاً أضف زر تعديل اسم الكاشير في HTML بعد عنوان الصفحة:**

```html
<div style="text-align: center; margin-bottom: 10px;">
    <button onclick="setCashierName()" style="background: #6c757d; width: auto; padding: 8px 16px;">
        <i class="fas fa-user-edit"></i> Set Cashier Name
    </button>
</div>
```

**المشكلة كانت:**

- تعريف `savedCashierName` مرتين في نفس الدالة
- عدم تعريف متغيرات الشيفت (`isShiftOpen`, `shiftStartTime`, `shiftOrders`)
- عدم تعريف دالة `toggleShift()`


بعد هذه التعديلات سيعمل الكود بدون أخطاء.